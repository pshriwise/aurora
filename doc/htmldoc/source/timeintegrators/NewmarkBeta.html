<!DOCTYPE html><head><meta charset="UTF-8"><title>NewmarkBeta | Aurora App</title><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/civet_moose.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../contrib/katex/katex.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://aurora-multiphysics.github.io/aurora/" class="left moose-logo hide-on-med-and-down">Aurora App</a><a href="https://github.com/aurora-multiphysics/aurora" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"></ul><a href="#" class="sidenav-trigger" data-target="0fcf74a3-59d4-4bd4-a8e1-a2d7e1c8147e"><i class="material-icons">menu</i></a><ul class="sidenav" id="0fcf74a3-59d4-4bd4-a8e1-a2d7e1c8147e"></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="https://aurora-multiphysics.github.io/aurora/" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href=".." class="breadcrumb">source</a><span class="breadcrumb">timeintegrators</span><a href="#" class="breadcrumb">NewmarkBeta</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="1eca478d-a53e-4dc5-bb12-92029d4ecbaa" data-section-level="1" data-section-text="NewmarkBeta"><h1 id="newmarkbeta">NewmarkBeta</h1><p>Computes the first and second time derivative of variable using Newmark-Beta method.</p><section class="scrollspy" id="8da344e7-220a-40a3-8638-079c391f9254" data-section-level="2" data-section-text="Description"><h2 id="description">Description</h2><p>Newmark time integration (<a href="#newmark1959amethod">Newmark, 1959</a>) is one of the commonly used time integration methods in structural dynamics problems. In this method, the second (<span class="moose-katex-inline-equation" id="moose-equation-7796708c-2c26-4635-8b7a-865e81b40240"><script>var element = document.getElementById("moose-equation-7796708c-2c26-4635-8b7a-865e81b40240");katex.render("\\ddot{u}", element, {displayMode:false,throwOnError:false});</script></span>) and first (<span class="moose-katex-inline-equation" id="moose-equation-1c7ff1a1-603a-4b74-b865-85dd86442849"><script>var element = document.getElementById("moose-equation-1c7ff1a1-603a-4b74-b865-85dd86442849");katex.render("\\dot{u}", element, {displayMode:false,throwOnError:false});</script></span>) time derivatives of a variable <span class="moose-katex-inline-equation" id="moose-equation-1e6e1b1d-f48b-45bd-8441-6668113b9185"><script>var element = document.getElementById("moose-equation-1e6e1b1d-f48b-45bd-8441-6668113b9185");katex.render("u", element, {displayMode:false,throwOnError:false});</script></span> at <span class="moose-katex-inline-equation" id="moose-equation-5571d23b-4548-411c-bef7-1ccffb1695dc"><script>var element = document.getElementById("moose-equation-5571d23b-4548-411c-bef7-1ccffb1695dc");katex.render("t+\\Delta t", element, {displayMode:false,throwOnError:false});</script></span> are written in terms of the <span class="moose-katex-inline-equation" id="moose-equation-ec88bf37-cbbf-4a17-97fc-22eb59e7b493"><script>var element = document.getElementById("moose-equation-ec88bf37-cbbf-4a17-97fc-22eb59e7b493");katex.render("u", element, {displayMode:false,throwOnError:false});</script></span>, <span class="moose-katex-inline-equation" id="moose-equation-7ec3c270-0668-4030-bf40-062cdf9c1f0b"><script>var element = document.getElementById("moose-equation-7ec3c270-0668-4030-bf40-062cdf9c1f0b");katex.render("\\dot{u}", element, {displayMode:false,throwOnError:false});</script></span> and <span class="moose-katex-inline-equation" id="moose-equation-91635405-4b43-414e-a3cd-6273489ab67b"><script>var element = document.getElementById("moose-equation-91635405-4b43-414e-a3cd-6273489ab67b");katex.render("\\ddot{u}", element, {displayMode:false,throwOnError:false});</script></span> at time <span class="moose-katex-inline-equation" id="moose-equation-80839bc0-ff2d-4069-8298-1c8b2ed43285"><script>var element = document.getElementById("moose-equation-80839bc0-ff2d-4069-8298-1c8b2ed43285");katex.render("t", element, {displayMode:false,throwOnError:false});</script></span>, and <span class="moose-katex-inline-equation" id="moose-equation-6431cd6f-7960-4aee-8c77-1d269ffffc10"><script>var element = document.getElementById("moose-equation-6431cd6f-7960-4aee-8c77-1d269ffffc10");katex.render("u", element, {displayMode:false,throwOnError:false});</script></span> at <span class="moose-katex-inline-equation" id="moose-equation-5503112c-ff8e-4811-85e7-4a264d255873"><script>var element = document.getElementById("moose-equation-5503112c-ff8e-4811-85e7-4a264d255873");katex.render("t+\\Delta t", element, {displayMode:false,throwOnError:false});</script></span> as shown below:</p><p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-72b91066-58f3-447c-b54d-c3736dfebe09"></span><script>var element = document.getElementById("moose-equation-72b91066-58f3-447c-b54d-c3736dfebe09");katex.render("\\begin{aligned} \\mathbf{\\ddot{u}}(t+\\Delta t) &=& \\frac{\\mathbf{u}(t+\\Delta t)-\\mathbf{u}(t)}{\\beta \\Delta t^2}- \\frac{\\mathbf{\\dot{u}}(t)}{\\beta \\Delta t}+\\frac{\\beta -0.5}{\\beta}\\mathbf{\\ddot{u}}(t) \\\\ \\mathbf{\\dot{u}}(t+ \\Delta t) &=& \\mathbf{\\dot{u}}(t)+ (1-\\gamma)\\Delta t \\mathbf{\\ddot{u}}(t) + \\gamma \\Delta t \\mathbf{\\ddot{u}}(t+\\Delta t) \\end{aligned}", element, {displayMode:true,throwOnError:false});</script></span></p><p>In the above equations, <span class="moose-katex-inline-equation" id="moose-equation-7a12cca9-6b0a-4618-b958-1f2e6c5e29fd"><script>var element = document.getElementById("moose-equation-7a12cca9-6b0a-4618-b958-1f2e6c5e29fd");katex.render("\\beta", element, {displayMode:false,throwOnError:false});</script></span> and <span class="moose-katex-inline-equation" id="moose-equation-7b6f8d4d-6329-4c77-809b-ff2cd09e5d7a"><script>var element = document.getElementById("moose-equation-7b6f8d4d-6329-4c77-809b-ff2cd09e5d7a");katex.render("\\gamma", element, {displayMode:false,throwOnError:false});</script></span> are Newmark time integration parameters.</p><ul class="browser-default"><li><p>For <span class="moose-katex-inline-equation" id="moose-equation-5352453a-40f0-49ef-b37c-a31bda01cb9a"><script>var element = document.getElementById("moose-equation-5352453a-40f0-49ef-b37c-a31bda01cb9a");katex.render("\\beta = \\frac{1}{4}", element, {displayMode:false,throwOnError:false});</script></span> and <span class="moose-katex-inline-equation" id="moose-equation-a3e1a96b-1bad-4551-b522-2c437bcc412b"><script>var element = document.getElementById("moose-equation-a3e1a96b-1bad-4551-b522-2c437bcc412b");katex.render("\\gamma = \\frac{1}{2}", element, {displayMode:false,throwOnError:false});</script></span>, the Newmark time integration method is implicit, unconditionally stable and second order accurate in time. This is the constant average acceleration method with no numerical damping. </p></li><li><p><span class="moose-katex-inline-equation" id="moose-equation-8dcc6d2d-b0fe-4c6c-9ab5-33f5af6fcb12"><script>var element = document.getElementById("moose-equation-8dcc6d2d-b0fe-4c6c-9ab5-33f5af6fcb12");katex.render("\\beta = \\frac{1}{6}", element, {displayMode:false,throwOnError:false});</script></span> and <span class="moose-katex-inline-equation" id="moose-equation-29ad4ac7-4c90-4ee0-ba6b-227569a75150"><script>var element = document.getElementById("moose-equation-29ad4ac7-4c90-4ee0-ba6b-227569a75150");katex.render("\\gamma = \\frac{1}{2}", element, {displayMode:false,throwOnError:false});</script></span> results in the linear acceleration method where the acceleration is linearly varying between <span class="moose-katex-inline-equation" id="moose-equation-e5ac4ccd-6927-4af5-8b45-be8aab191088"><script>var element = document.getElementById("moose-equation-e5ac4ccd-6927-4af5-8b45-be8aab191088");katex.render("t", element, {displayMode:false,throwOnError:false});</script></span> and <span class="moose-katex-inline-equation" id="moose-equation-57de57d1-4807-4d60-8799-6e65497225da"><script>var element = document.getElementById("moose-equation-57de57d1-4807-4d60-8799-6e65497225da");katex.render("t+\\Delta t", element, {displayMode:false,throwOnError:false});</script></span>. This method is also implicit, unconditionally stable and second order accurate in time. However, there is a small numerical damping when the linear acceleration method is used. </p></li><li><p>For <span class="moose-katex-inline-equation" id="moose-equation-231dfdd5-84d7-43c6-941a-4d635428a1ac"><script>var element = document.getElementById("moose-equation-231dfdd5-84d7-43c6-941a-4d635428a1ac");katex.render("\\gamma = \\frac{1}{2}", element, {displayMode:false,throwOnError:false});</script></span>, the method is second order accurate and it is unconditionally stable for <span class="moose-katex-inline-equation" id="moose-equation-097ba235-72f8-4c5e-880c-e62788918a2a"><script>var element = document.getElementById("moose-equation-097ba235-72f8-4c5e-880c-e62788918a2a");katex.render("\\frac{1}{2} \\le \\gamma \\le 2 \\beta", element, {displayMode:false,throwOnError:false});</script></span>.</p></li></ul><p>When using the constant average acceleration method that has no numerical damping, high frequency noise can sometimes be observed in the velocity and acceleration time histories for a problem with prescribed displacement  (<a href="#bathe2012insight">Bathe and Noh, 2012</a>). Using other parameters for <span class="moose-katex-inline-equation" id="moose-equation-7f8f35d1-27aa-43ce-a065-83d4e3606fd8"><script>var element = document.getElementById("moose-equation-7f8f35d1-27aa-43ce-a065-83d4e3606fd8");katex.render("\\beta", element, {displayMode:false,throwOnError:false});</script></span> and <span class="moose-katex-inline-equation" id="moose-equation-4ce57d8c-77f6-4624-a828-8f8ce954553f"><script>var element = document.getElementById("moose-equation-4ce57d8c-77f6-4624-a828-8f8ce954553f");katex.render("\\gamma", element, {displayMode:false,throwOnError:false});</script></span> results in non-zero numerical damping that damps out part of the high frequency noise but not all of it. Hilber-Hughes-Taylor (HHT) time integration is a variation of the Newmark method that damps out high frequency noise especially in structural dynamics problems. More details about this Newmark and HHT time integration schemes can be found in these <a href="http://people.duke.edu/~hpgavin/cee541/NumericalIntegration.pdf">lecture notes</a>. HHT time integration requires modification to the equation of motion and is currently implemented only for structural dynamics problems in tensor mechanics module.</p><p>When using Newmark time integration in structural dynamics problems that require an initial static step (most commonly for gravity analysis), a convenient method in MOOSE is to disable the inertia kernels (which can be done using the <a href="../../syntax/Controls/index.html">controls system</a>), the velocity and acceleration calculations, and the stiffness damping (which can be done by setting <code>static_initialization=true</code> in the stressdivergence kernels) during the first time step. This leads to solving the equation, Ku = F, in the first time step, which essentially initializes displacements and stresses from gravity loading. When using the Newmark-Beta time integrator (which we most often use for dynamics) or any other time integrator, we cannot switch off time derivatives (velocity and acceleration) calculations through the control system. Therefore, the time integrator will compute velocity and acceleration for the static step. When using the Newmark-Beta time integration for this purpose, this will result in noisy acceleration and velocity responses in the whole simulation. Such spurious responses can be avoided by using the <code>inactive_tsteps</code> parameter. This parameter ensures that the the NewmarkBeta time integrator returns zero derivatives for the first few time steps and starting the acceleration and velocity calculations after that. The time derivative calculations are started when the time step number is greater than <code>inactive_tsteps</code>.</p><p>A sample result of using this parameter is shown in <a href="#fig:disp">Figure 1</a>, <a href="#fig:vel">Figure 2</a>, and <a href="#fig:accel">Figure 3</a> below. The result corresponds to the time derivative of a ramp function, which is typically the displacement response under gravity. The velocities and accelerations calculated for this function without using the <code>inactive_tsteps</code> parameter (blue) and using <code>inactive_tsteps=1</code> (orange) are shown. The input syntax used to generate the orange plots below is listed after the figures below.</p><div class="row"><div class="card moose-float" style="width:30%;float:left;padding-top:2.5%" id="fig:disp"><div class="card-content"><picture class="materialboxed moose-image"><img src="../../media/time_integrators/inactive_tsteps_u.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 1: </span><span class="moose-caption-text">Displacement</span></p></div></div><div class="card moose-float" style="width:30%;float:left;padding-top:2.5%" id="fig:vel"><div class="card-content"><picture class="materialboxed moose-image"><img src="../../media/time_integrators/inactive_tsteps_udot.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 2: </span><span class="moose-caption-text">Velocity</span></p></div></div><div class="card moose-float" style="width:30%;float:left;padding-top:2.5%" id="fig:accel"><div class="card-content"><picture class="materialboxed moose-image"><img src="../../media/time_integrators/inactive_tsteps_udotdot.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 3: </span><span class="moose-caption-text">Acceleration</span></p></div></div><p></p></div><pre class="moose-pre" style="max-height:350px;"><code class="language-text">[Executioner]
  type = Transient
  start_time = 0.0
  num_steps = 6
  dt = 0.1
  [TimeIntegrator]
    type = NewmarkBeta
    inactive_tsteps = 1
  []
[]
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#a1961362-2dfa-429b-acf5-5029f1e79f64">(../../../SoftwareDownloads/moose/test/tests/time_integrators/newmark-beta/newmark_beta_inactive_steps.i)</a></section><section class="scrollspy" id="d26a5f30-f0f6-4a06-a017-b3761831324e" data-section-level="2" data-section-text="Input Parameters"><h2 id="input-parameters">Input Parameters</h2><section id="c16a3c53-2259-4e3e-8f9d-b5dfa97581d0" data-section-level="3" data-section-text="Optional Parameters" data-details-open="open"><details class="moose-section-content" open="open"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">beta</span><span class="moose-parameter-header-default">0.25</span><span class="moose-parameter-header-description">beta value</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>0.25</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>double</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>beta value</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">gamma</span><span class="moose-parameter-header-default">0.5</span><span class="moose-parameter-header-description">gamma value</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>0.5</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>double</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>gamma value</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">inactive_tsteps</span><span class="moose-parameter-header-default">0</span><span class="moose-parameter-header-description">The time derivatives will set to be zero for this number of time steps.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>0</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>int</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The time derivatives will set to be zero for this number of time steps.</p></div></li></ul><summary><h3 data-details-open="open"><span class="moose-section-icon"></span>Optional Parameters</h3></summary></details></section><section id="51ce3eaa-9937-4745-aa11-ed5117a2fe76" data-section-level="3" data-section-text="Advanced Parameters" data-details-open="close"><details class="moose-section-content"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">control_tags</span><span class="moose-parameter-header-description">Adds user-defined labels for accessing object parameters via control logic.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;std::string&gt;</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Adds user-defined labels for accessing object parameters via control logic.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">enable</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">Set the enabled status of the MooseObject.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Set the enabled status of the MooseObject.</p></div></li></ul><summary><h3 data-details-open="close"><span class="moose-section-icon"></span>Advanced Parameters</h3></summary></details></section></section><section class="scrollspy" id="257ac9c2-69b0-4ff9-9797-589b99708aa0" data-section-level="2" data-section-text="References"><h2 id="references">References</h2><div class="moose-bibliography"><ol><li id="bathe2012insight">K.&nbsp;J. Bathe and G.&nbsp;Noh.
Insight into an implicit time integration scheme for structural dynamics.
<em>Computers and Structures</em>, 98-99:1&ndash;6, 2012.<a href="#bdb6eead-4e4b-4e82-88a8-50a28d874d55" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="bdb6eead-4e4b-4e82-88a8-50a28d874d55"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{bathe2012insight,
    author = "Bathe, K. J. and Noh, G.",
    title = "Insight into an implicit time integration scheme for structural dynamics",
    journal = "Computers and Structures",
    volume = "98-99",
    pages = "1-6",
    year = "2012"
}
</code></pre></div></div></li><li id="newmark1959amethod">N.&nbsp;M. Newmark.
A method of computation for structural dynamics.
<em>Journal of Engineering Mechanics</em>, 85(EM3):67–94, 1959.<a href="#bc2a0625-e755-403d-b2fa-0634714a6aa2" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="bc2a0625-e755-403d-b2fa-0634714a6aa2"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{newmark1959amethod,
    author = "Newmark, N. M.",
    title = "A method of computation for structural dynamics",
    journal = "Journal of Engineering Mechanics",
    publisher = "ASCE",
    volume = "85",
    number = "EM3",
    pages = "67--94",
    year = "1959"
}
</code></pre></div></div></li></ol></div></section></section><div class="moose-modal modal" id="a1961362-2dfa-429b-acf5-5029f1e79f64"><div class="modal-content"><h4>(../../../SoftwareDownloads/moose/test/tests/time_integrators/newmark-beta/newmark_beta_inactive_steps.i)</h4><pre class="moose-pre"><code class="language-text">###########################################################
# This is a simple test with a time-dependent problem
# demonstrating the use of the TimeIntegrator system.
#
# Testing that the active_time parameter works as intended.
#
###########################################################

[Mesh]
  type = GeneratedMesh
  dim = 2
  xmin = -1
  xmax = 1
  ymin = -1
  ymax = 1
  nx = 1
  ny = 1
[]

[Variables]
  [u]
  []
[]

[Functions]
  [forcing_fn]
    type = PiecewiseLinear
    x = &#x27;0.0 0.1 0.6&#x27;
    y = &#x27;0.0 1.0 1.0&#x27;
  []
[]

[Kernels]
  [ie]
    type = TimeDerivative
    variable = u
  []

  [diff]
    type = Diffusion
    variable = u
  []
[]

[BCs]
  [left]
    type = DirichletBC
    variable = u
    boundary = &#x27;left&#x27;
    value = 0
  []
  [right]
    type = FunctionDirichletBC
    variable = u
    boundary = &#x27;right&#x27;
    function = forcing_fn
  []
[]

[Executioner]
  type = Transient
  start_time = 0.0
  num_steps = 6
  dt = 0.1
  [TimeIntegrator]
    type = NewmarkBeta
    inactive_tsteps = 1
  []
[]

[Postprocessors]
  [udot]
    type = ElementAverageTimeDerivative
    variable = u
  []
  [udotdot]
    type = ElementAverageSecondTimeDerivative
    variable = u
  []
  [u]
    type = ElementAverageValue
    variable = u
  []
[]

[Outputs]
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#8da344e7-220a-40a3-8638-079c391f9254" class="tooltipped" data-position="left" data-tooltip="Description">Description</a></li><li><a href="#d26a5f30-f0f6-4a06-a017-b3761831324e" class="tooltipped" data-position="left" data-tooltip="Input Parameters">Input Parameters</a></li><li><a href="#257ac9c2-69b0-4ff9-9797-589b99708aa0" class="tooltipped" data-position="left" data-tooltip="References">References</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script>